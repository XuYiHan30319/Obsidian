# 链路层概述
首先我们将任何运行链路层协议的设备叫 #节点 ,节点包括主机,路由器,交换机.我们也把沿着通信链路相连接的相邻顶点的通信道路叫做链路.
为了将一个数据报从源主机传输到目的的主机,数据报必须通过沿着端到路径上的各段链路传输.在通过特定的链路时,传输节点将数据包封装在 #链路层帧 中,并将改帧传输到链路
## 链路层提供的服务
链路层协议提供的可能服务包括:
- #成帧 在每个网络层数据报经过链路传送之前,几乎所有的链路层协议都要用链路层封装起来,一个帧由一个数据字段和若干首部字段组成,其中网络层数据包就插在数据字段中.
- 链路介入 #媒体访问控制 #MAC 协议规定了帧在链路上传输的规则.MAC协议用于协调多个节点的帧传输
- 可靠交付.当链路层协议提供可靠交付服务时,他保证无差错的经链路层移动每个网络层数据报.链路层的可靠数据传输通常也是通过确认和重传取得的链路.
- 差错检测和纠正
## 链路层在何处实现
链路层的主体部分实在 #网络适配器 中实现的,网络适配器有时也被称为 #网络接口卡 ,位于网络适配器核心的是链路层控制器.发送端,控制器获得了由协议栈高层生成并存储在主机中的数据报,在链路层帧中封装该数据报,燃火遵循链路接入协议将该帧传进通信链路.在接收端,控制器接受了整个帧,抽出其中的网络层数据报.
![[Pasted image 20221124104517.png]]

# 差错检测和纠正技术
#比特差错检测和纠正 ,即从一个节点发送到另一个物理连接上的临近节点的链路层帧中的比特损伤就行检测和纠正.一般而言,差错检测和纠正技术越复杂,导致的开销越大,意味着更多的计算量和纠错比特
## 奇偶校验
最简单的方式就是用单个的 #奇偶校验位 在偶校验方案中,发送发只需要包含一个附加的比特,使得d+1比特中1的个数是偶数,同样的奇校验是奇数
对于接收方,只需要数一数比特1的个数,如果不对,那么说明出现了奇数个数的比特差错
![[Pasted image 20221124105245.png]]
我们可以使用另一种方式来检验,这种方式叫 #二维奇偶校验  .d个比特被划分为i行j列.对每行每列计算奇偶值,可以纠正一位差错
接收方检测和纠正差错的能力被称为 #前向纠错 fec
![[Pasted image 20221124105609.png]]

## 循环冗余检测
现今计算机网络广泛引用的差错纠正技术基于 #循环冗余检测编码 CRC编码,也称为多项式编码.
CRC编码操作如下,考虑d比特数据D,发送节点要把他发送给接受节点发送方和接收方首先需要协商一个r+1比特模式,称为 #生成多项式 ,我们表示为G,
然后给一个数据段D,发送方附加r个附加比特R,并且将他们附加到D上,得到d+r比特模式用摸2运算恰能被g整除
![[Pasted image 20221124110210.png]]
以下是D=101110,d=6,G=1001,r=3下的计算过程,这种情况下传输的9个比特是101110011,减法逻辑是相同得0,不同得1,注意取得的R是最后3位
![[Pasted image 20221124110508.png]]

# 多路访问链路和协议
有两种类型的网络链路: #点对点链路 和 #广播链路 .
- 点对点链路由链路的一段的单个发送方和链路另一端的单个接收方组成
- 广播链路能让多个发送方和接受节点都连接到相同的单一的广播信道上.如何协调多个发送和接收节点对同一个共享广播信道的访问就是 #多路访问问题 

计算机网络有类似的协议，也就是所谓的多路访问协议（multiple access protocol）,即节点通过这些协议来规范它们在共享的广播信道上的传输行为.因为所有的节点都能传输帧,所以多个节点可能会同时传输帧,当这种情况,所有节点同时接受多个帧,这就是说,传输的帧在所有的接收方处 #碰撞 ,所有的信号都丢失了,浪费了带宽
我们能将任何多路访问协议划分为3类: #信道划分协议 #随机接入协议 和 #轮流协议
## 信道划分协议
假设一个支持N个节点的信道且信道的传输速率为Rbps,TDM将时间划分为 #时间帧 ,并且把每个时间帧划分为N个 #时隙 
![[Pasted image 20221124112102.png]]
每个节点在每个帧时间内得到了专用的传输速率R/Nbps.但是他有两个主要<font color="#ff0000">缺陷</font>.首先,节点被限制于R/N bps的平均速率,即使他是唯一要发送的节点.其二,节点必须等待他在传输序列中的轮次. #码分复用 FDM和 #时分复用 TDM的缺陷基本一致
第三中信道划分协议叫 #码分多址 CDMA为每个节点分配一种不同的编码,如果精心选择编码,即使同时传输,也能区分出哪些是自己的

## 随机接入协议
在随机接入协议中,一个传输节点总是以信道的全部速率发送,当有碰撞,涉及碰撞的每个节点反复重发,到该帧无碰撞 通过为止,但是每次碰撞之后,不必立即重发
### 时隙ALOHA
#时隙ALOHA 
如果p是一个概率,那么
- 每当一个帧要发送,等到下一个时隙开始传输整个帧
- 如果没有碰撞,传输成功,不需要重传
- 如果有碰撞,接点在时隙结束前检测到,该节点以概率p在后续的每个时隙重传,直到无碰撞的传出去

多个节点的情况下有奖如何工作呢?
刚好有节点传输的时隙被称为 #成功时隙 .我们将时隙多路访问协议的 #效率 定义为:当有多个节点且每个节点都有大量帧要发送是,长期运行中成功时隙的份额.因此,一个给定节点传送成功的概率为$p(1-p)^{N-1}$,有节点传送成功的概率为$Np(1-p)^{N-1}$.最大效率大约为0.37
![[Pasted image 20221124122951.png]]
### ALOHA
时隙ALOHA要求所有节点同步他们的传输,以在每个时隙开始时开始传输.第一个ALOHA协议实际上是一个非时隙,完全分散的协议.当帧第一次到达是,节点在完全传输完他的碰撞帧之后把这个帧完全的传输入广播信道.如果这个帧发生了碰撞,则立即以概率p重传,否则等待一个帧传输时间后该节点以概率P重传该帧.这种效率为时隙ALOHA的一半
![[Pasted image 20221124123933.png]]

### 载波监听多路访问(CSMA)
#载波监听多路访问 
- 说话之前先听.被称为 #载波监听 ,即一个节点在传输前线听信道,如果正在使用,则等待一小段时间直到没有被使用时才开始传输
- 如果与他人同时开始说话,则不说话,这被称为 #碰撞检测  . 
这两个规则被包含在载波监听多路访问和具有碰撞检测的CSMA中
### 轮流协议
#轮流协议 为了解决当有M个节点活跃,每个节点吞吐率接近R/Mbps.
第一种是 #轮询协议,节点之一被任命为主节点,主节点以循环方式轮询每个节点,首先告诉1他能传输多少帧,然后告诉2他能传输多少帧 
另一种是 #令牌传递协议 这种协议没有主节点,一个称为令牌的特殊帧在其间交换,仅当有帧要发送,一个节点才能持有这个令牌,否则他立即传送给下一个节点.

# 交换局域网
## MAC地址
#MAC地址 
并不是主机或路由器具有链路层地址,而是他们的适配器具有链路层地址.因此具有多个网络接口的主机或者路由器将具有与之关联的多个链路层地址,就像他也具有与之相连的多个IP地址一样.链路层地址有不同的称呼:LAN地址,物理地址,MAC地址
## 地址解析协议
因为存在着网络层地址和链路层地址(即Ip与MAC),所以需要在他们之间转换.对于因特网而言,这是 #地址解析协议 ARP的任务.
