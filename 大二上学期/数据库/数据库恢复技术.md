# 事务
所谓事务是用户定义的一个数据库操作序列,这些操作也么全做,要么全部做,是一个不可分割的工作单位
事务通常以beginningBEGIN TRANSACTIOn开始,以commit或者rollback结束
## 事务的ACID特性
- 原子性 事务要么都做,要么都不做
- 一致性 如，某公司在银行中有A，B两个账号，现在公司想从账号 A 中取出一万元，存入账号B。那么就可以定义一个事务，该事务包括两个操作，第一个操作是从账号 A 中减去一万元，第二个操作是向账号B中加入一万元。这两个操作要么全做，要么全不做。全做或者全不做，数据库都处于一致性状态。如果只做一个操作，则逻辑上就会发生错误，减少或增加-万元，这时数据库就处于不一致性状态了。可见一致性与原子性是密相关的。
- 隔离性 一个事物的执行不能被其他事物干扰,并发的事务也不能互相干扰
- 持续性/永久性 一个事物一旦提交,他对数据库的影响是永久的

# 故障的种类
1. 事物内部的故障,事务内部更多的故障是非预期的,不能有应用程序处理的
2. 系统故障 系统故障是指造成系统停止运转的任何事件,使得系统需要<font color="#ff0000">重新启动</font>
3. 介质故障 破坏性最大,比如磁盘损坏
4. 计算机病毒


# 恢复的实现技术
恢复技术最主要的就是建立冗余数据.建立冗余数据最常用的技术就是数据转储和登记日志文件
## 数据转储
就是定期备份,当数据库收到破坏之后可以将后备副本重新装入,但想要恢复到破坏前的状态需要使用日志文件
转储又可以分为静态转储和动态转储
- 静态转储就是系统无运行事务的时候进行的转储操作,转储期间不允许任何操作
- 动态转储是转储期间允许对数据库进行存取和修改
## 检查点技术
![[Pasted image 20221209162921.png]]
在检查点之前的事件不需要重做,检查点之后的需要重做
![[Pasted image 20221209164027.png]]
在这个图里面,无论发生在哪,在这个错误发生前没有提交的都要重做
