# Adventures in classes

[toc]

## 拷贝构造函数

> c++的类自动提供以下函数：默认构造函数，析构函数，地址，拷贝和赋值运算符

拷贝构造函数：class_name(const class_name&)

```c++
//以下都是拷贝构造函数
stringBad motool;

stringBad a(mottol);
stringBad b = mottol;
stringBad c = stringBad(mottol)
```

-> 浅拷贝和深拷贝

```c++
stringBad::stringBad(const stringBad&s){
  std::strcpy(str,s.str);
}
```

除了拷贝构造函数，我们还需要重定义赋值运算符

```c++
stringBad& stringBad::operator=(const stringBad &s){
 	if (this==&s){//防止自己等于自己
  	return *this;
 	}
  delete []this->str;//防止内存泄漏
  ....
  return *this;
}

//当然，在初始化的时候有时候会用拷贝构造函数代替=
stringBad knot;
stringBad metoo = knot;//有时候是=，有时候是拷贝，按情况而定
```





## 列表初始化

```c++
class X{
  int x1;
  const int x2;
  int &x3;//&和const必须使用列表初始化，因为他们在类生成之前就初始好了
}

X::X(int m1,int m2,int &m3):x2(m2),x3(m3){
  x1 = m1;
}
```

